# åŠ¨æ‰‹å°è¯•

<CourseFloatingBanner classNames="absolute z-10 right-0 top-0"
notebooks={[
  {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/deep-rl-class/blob/main/notebooks/unit5/unit5.ipynb"}
  ]}
  askForHelpUrl="http://hf.co/join/discord" />


æˆ‘ä»¬äº†è§£äº† ML-Agents æ˜¯ä»€ä¹ˆä»¥åŠå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬è¿˜ç ”ç©¶äº†æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ä¸¤ç§ç¯å¢ƒã€‚ç°åœ¨æˆ‘ä»¬å‡†å¤‡å¥½è®­ç»ƒæˆ‘ä»¬çš„æ™ºèƒ½ä½“äº†ï¼

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/envs.png" alt="Environments" />

Hub ä¸Šçš„ ML-Agents éƒ¨åˆ†**ä»å¤„äºè¯•éªŒé˜¶æ®µ**ã€‚å°†æ¥ä¼šæ·»åŠ ä¸€äº›åŠŸèƒ½ã€‚ä½†å°±ç›®å‰è€Œè¨€ï¼Œè¦éªŒè¯è®¤è¯è¿‡ç¨‹çš„å®é™…æ“ä½œï¼Œä½ åªéœ€å°†ç»è¿‡è®­ç»ƒçš„æ¨¡å‹æ¨é€åˆ° Hub ä¸Šã€‚éªŒè¯æ­¤åŠ¨æ‰‹å°è¯•æ²¡æœ‰æœ€ä½é™åº¦ç»“æœã€‚ä½†å¦‚æœä½ æƒ³è·å¾—ä¸é”™çš„ç»“æœï¼Œä½ å¯ä»¥å°è¯•åœ¨ä¸‹é¢ç»“æœä¹‹ä¸Šï¼š

- é’ˆå¯¹ [Pyramids ç¯å¢ƒ](https://singularite.itch.io/pyramids): å¹³å‡å¥–åŠ± = 1.75
- é’ˆå¯¹ [SnowballTarget ç¯å¢ƒ](https://singularite.itch.io/snowballtarget): å¹³å‡å¥–åŠ± = ä¸€å›åˆ 15 æˆ– 30 ä¸ªç›®æ ‡å°„å‡»ã€‚

æœ‰å…³è®¤è¯è¿‡ç¨‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤éƒ¨åˆ† ğŸ‘‰ https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process

**ç‚¹å‡»ä¸‹æ–¹å¼€å§‹å°è¯•æœ¬æ¬¡å®éªŒ** ğŸ‘‡ :

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/huggingface/deep-rl-class/blob/master/notebooks/unit5/unit5.ipynb)

# ç¬¬ 5 å•å…ƒï¼š ML-Agents ç®€ä»‹

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/thumbnail.png" alt="Thumbnail"/>

åœ¨æœ¬ notebook ä¸­ï¼Œ ä½ å°†äº†è§£ ML-Agents å¹¶è®­ç»ƒä¸¤ä¸ªæ™ºèƒ½ä½“ã€‚

- ç¬¬ä¸€ä¸ªå°†å­¦ä¹ **å°†é›ªçƒå°„åˆ°ç”Ÿæˆçš„ç›®æ ‡ä¸Š**ã€‚
- ç¬¬äºŒä¸ªéœ€è¦æŒ‰ä¸€ä¸ªæŒ‰é’®æ¥ç”Ÿæˆé‡‘å­—å¡”ï¼Œç„¶åå¯¼èˆªåˆ°é‡‘å­—å¡”ï¼Œå°†å…¶æ‰“å€’ï¼Œ**ç„¶åç§»åŠ¨åˆ°é¡¶éƒ¨çš„é‡‘ç –**ã€‚ä¸ºæ­¤ï¼Œå®ƒéœ€è¦æ¢ç´¢å…¶ç¯å¢ƒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç§ç§°ä¸ºå¥½å¥‡å¿ƒçš„æŠ€æœ¯ã€‚

ä¹‹åï¼Œä½ å°†èƒ½å¤Ÿç›´æ¥åœ¨**æµè§ˆå™¨ä¸Šè§‚çœ‹ä½ çš„æ™ºèƒ½ä½“è¿è¡Œã€‚**

æœ‰å…³è®¤è¯è¿‡ç¨‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤éƒ¨åˆ† ğŸ‘‰ https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process

â¬‡ï¸ **è¿™æ˜¯æ‚¨å°†åœ¨æœ¬å•å…ƒç»“æŸæ—¶å®ç°**çš„ç¤ºä¾‹ã€‚â¬‡ï¸

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/pyramids.gif" alt="Pyramids"/>

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/snowballtarget.gif" alt="SnowballTarget"/>

### ğŸ® ç¯å¢ƒ:

- [Pyramids](https://github.com/Unity-Technologies/ml-agents/blob/main/docs/Learning-Environment-Examples.md#pyramids)
- SnowballTarget

### ğŸ“š RL-åº“:

- [ML-Agents (HuggingFace å®éªŒç‰ˆæœ¬)](https://github.com/huggingface/ml-agents)

âš  æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå®éªŒç‰ˆæœ¬çš„ ML-Agents ï¼Œä½ å¯ä»¥å°†å…¶æ¨é€åˆ° Hub å¹¶ä» Hub ä¸­åŠ è½½ Unity ML-Agents æ¨¡å‹ã€‚è¯·æ³¨æ„ï¼Œ**ä½ éœ€è¦å®‰è£…ç›¸åŒçš„ç‰ˆæœ¬**ã€‚

æˆ‘ä»¬ä¼šæŒç»­æå‡æˆ‘ä»¬çš„æ•™ç¨‹è´¨é‡ï¼Œ**å¦‚æœä½ åœ¨æœ¬ notebook ä¸­å‘ç°äº†ä»€ä¹ˆé—®é¢˜**è¯· [åœ¨ Github Repo ä¸Šæå‡º issue](https://github.com/huggingface/deep-rl-class/issues)ã€‚

## æœ¬ notebook çš„ç›®æ ‡ ğŸ†

åœ¨ notebook ç»“æŸåï¼Œä½ å°†ä¼šå¾—åˆ°ï¼š

- äº†è§£ç¯å¢ƒåº“å’Œ **ML-Agents** çš„å·¥ä½œåŸç†ã€‚
- èƒ½å¤Ÿåœ¨ **Unity ç¯å¢ƒä¸­è®­ç»ƒæ™ºèƒ½ä½“**ã€‚

## å‰ç½®å‡†å¤‡ ğŸ—ï¸
åœ¨è¿›å…¥ notebook å‰ï¼Œä½ éœ€è¦ï¼š

ğŸ”² ğŸ“š ** é€šè¿‡é˜…è¯»ç¬¬ 5 å•å…ƒå†…å®¹å­¦ä¹ [ä»€ä¹ˆæ˜¯ ML-Agents å¹¶ä¸”ä»–æ˜¯æ€ä¹ˆå·¥ä½œçš„](https://huggingface.co/deep-rl-course/unit5/introduction)**  ğŸ¤—

# è®©æˆ‘ä»¬è®­ç»ƒæˆ‘ä»¬çš„æ™ºèƒ½ä½“ ğŸš€

## è®¾ç½® GPU  ğŸ’ª

- ä¸ºäº† **åŠ é€Ÿæ™ºèƒ½ä½“çš„è®­ç»ƒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ GPU**. ç‚¹å‡» `Runtime > Change Runtime type`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step1.jpg" alt="GPU Step 1">

- `Hardware Accelerator > GPU`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step2.jpg" alt="GPU Step 2">

## å…‹éš†ä»“åº“å¹¶å®‰è£…ä¾èµ– ğŸ”½
- æˆ‘ä»¬éœ€è¦å…‹éš†ä»“åº“ï¼Œè¯¥ä»“åº“**åŒ…å«è¯¥åº“çš„å®éªŒç‰ˆæœ¬å…è®¸ä½ å°†è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“æ¨é€åˆ° Hub ä¸Šã€‚**

```python
%%capture
# Clone the repository
!git clone --depth 1 --branch hf-integration https://github.com/huggingface/ml-agents
```

```python
%%capture
# Go inside the repository and install the package
%cd ml-agents
!pip3 install -e ./ml-agents-envs
!pip3 install -e ./ml-agents
```

## SnowballTarget â›„

å¦‚æœä½ éœ€è¦å›é¡¾ä»¥ä¸‹è¯¥ç¯å¢ƒæ€ä¹ˆè¿è¡Œè¯·æŸ¥çœ‹è¿™éƒ¨åˆ† ğŸ‘‰
https://huggingface.co/deep-rl-course/unit5/snowball-target

### ä¸‹è½½å¹¶ç§»åŠ¨ç¯å¢ƒ zip æ–‡ä»¶åˆ° `./training-envs-executables/linux/`
- æˆ‘ä»¬çš„ç¯å¢ƒçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ä¸€ä¸ª zip æ–‡ä»¶ä¸­ã€‚
- æˆ‘ä»¬éœ€è¦ä¸‹è½½å®ƒå¹¶å°†å…¶æ”¾åˆ° `./training-envs-executables/linux/`
- å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ colab æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ Liunx å¯æ‰§è¡Œæ–‡ä»¶ï¼Œcolab çš„æœºå™¨æ“ä½œç³»ç»Ÿæ˜¯ Ubuntu (linux)

```python
# Here, we create training-envs-executables and linux
!mkdir ./training-envs-executables
!mkdir ./training-envs-executables/linux
```

ç”¨ `wget` ä» https://drive.google.com/file/d/1YHHLjyj6gaZ3Gemx1hQgqrPgSS2ZhmB5 ä¸‹è½½æ–‡ä»¶ SnowballTarget.zipã€‚

[åœ¨æ­¤å¤„](https://bcrf.biochem.wisc.edu/2021/02/05/download-google-drive-files-using-wget/) æŸ¥çœ‹ä» GDrive ä¸‹è½½å¤§æ–‡ä»¶çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ

```python
!wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id=1YHHLjyj6gaZ3Gemx1hQgqrPgSS2ZhmB5' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&id=1YHHLjyj6gaZ3Gemx1hQgqrPgSS2ZhmB5" -O ./training-envs-executables/linux/SnowballTarget.zip && rm -rf /tmp/cookies.txt
```

è§£å‹ executable.zip æ–‡ä»¶

```python
%%capture
!unzip -d ./training-envs-executables/linux/ ./training-envs-executables/linux/SnowballTarget.zip
```

ç¡®ä¿ä½ çš„æ–‡ä»¶å¯è®¿é—®

```python
!chmod -R 755 ./training-envs-executables/linux/SnowballTarget
```

### å®šä¹‰ SnowballTarget é…ç½®æ–‡ä»¶
- åœ¨ ML-Agents ä¸­, ä½ éœ€è¦åœ¨ config.yaml æ–‡ä»¶ä¸­å®šä¹‰**è®­ç»ƒçš„è¶…å‚æ•°**ã€‚

è¿™é‡Œæœ‰å¤šç§è¶…å‚æ•°ã€‚ä¸ºäº†æ›´å¥½äº†è§£ä»–ä»¬ï¼Œä½ åº”è¯¥åœ¨[æ–‡æ¡£](https://github.com/Unity-Technologies/ml-agents/blob/release_20_docs/docs/Training-Configuration-File.md)ä¸­æ£€æŸ¥æ¯ä¸ªè¶…å‚æ•°çš„å«ä¹‰ã€‚

ä½ éœ€è¦åœ¨ ./content/ml-agents/config/ppo/ ä¸‹åˆ›å»ºä¸€ä¸ª `SnowballTarget.yaml` é…ç½®æ–‡ä»¶ã€‚

æˆ‘ä»¬å°†ä¼šç»™ä½ ç¬¬ä¸€ç‰ˆçš„é…ç½®(å°†å…¶å¤åˆ¶ç²˜è´´åˆ° `SnowballTarget.yaml file`)ï¼Œ**ä½†ä½ éœ€è¦ä¼˜åŒ–å®ƒ**

```yaml
behaviors:
  SnowballTarget:
    trainer_type: ppo
    summary_freq: 10000
    keep_checkpoints: 10
    checkpoint_interval: 50000
    max_steps: 200000
    time_horizon: 64
    threaded: true
    hyperparameters:
      learning_rate: 0.0003
      learning_rate_schedule: linear
      batch_size: 128
      buffer_size: 2048
      beta: 0.005
      epsilon: 0.2
      lambd: 0.95
      num_epoch: 3
    network_settings:
      normalize: false
      hidden_units: 256
      num_layers: 2
      vis_encode_type: simple
    reward_signals:
      extrinsic:
        gamma: 0.99
        strength: 1.0
```

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/snowballfight_config1.png" alt="Config SnowballTarget"/>
<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/snowballfight_config2.png" alt="Config SnowballTarget"/>

ä½œä¸ºå®éªŒï¼Œå°½é‡ä¼˜åŒ–ä¸€äº›å…¶ä»–è¶…å‚æ•°ã€‚Unity åœ¨è¿™é‡Œæä¾›äº†[éå¸¸å¥½çš„æ–‡æ¡£å»è§£é‡Šæ¯ä¸€ä¸ªè¶…å‚æ•°](https://github.com/Unity-Technologies/ml-agents/blob/main/docs/Training-Configuration-File.md)ã€‚

ç°åœ¨ä½ å·²ç»åˆ›å»ºäº†é…ç½®æ–‡ä»¶å¹¶ä¸”ç†è§£å¤§éƒ¨åˆ†è¶…å‚æ•°çš„å«ä¹‰ï¼Œæˆ‘ä»¬å°±å‡†å¤‡å¼€å§‹è®­ç»ƒæˆ‘ä»¬çš„æ™ºèƒ½ä½“äº† ğŸ”¥ã€‚

### è®­ç»ƒæ™ºèƒ½ä½“

ä¸ºäº†è®­ç»ƒæˆ‘ä»¬çš„æ™ºèƒ½ä½“ï¼Œæˆ‘ä»¬éœ€è¦å»**è¿è¡Œ mlagents-learn å¹¶ä¸”é€‰æ‹©å¯æ‰§è¡Œçš„ç¯å¢ƒå®¹å™¨ã€‚**

æˆ‘ä»¬å®šä¹‰å››ä¸ªå‚æ•°ï¼š

1. `mlagents-learn <config>`: è¶…å‚æ•°é…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚
2. `--env`: å¯æ‰§è¡Œç¯å¢ƒä½ç½®ã€‚
3. `--run_id`: ä¸ºä½ çš„è®­ç»ƒè¿è¡Œ ID æŒ‡å®šåç§°ã€‚
4. `--no-graphics`: é˜²æ­¢åœ¨è®­ç»ƒä¸­å¯è§†åŒ–ã€‚

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/mlagentslearn.png" alt="MlAgents learn"/>

è®­ç»ƒæ¨¡å‹å¹¶ä¸”ä½¿ç”¨ `--resume` æ ‡è®°åœ¨æ‰“æ–­æƒ…å†µä¸‹ç»§ç»­è®­ç»ƒã€‚

> å¦‚æœæ‚¨ä½¿ç”¨äº† `--resume` å‚æ•°ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œå¯èƒ½ä¼šå¤±è´¥ã€‚è¯·å°è¯•é‡æ–°è¿è¡Œè¯¥ä»£ç å—ä»¥è·³è¿‡é”™è¯¯ã€‚

è®­ç»ƒå°†æ ¹æ®ä½ çš„é…ç½®éœ€è¦ 10 è‡³ 35 åˆ†é’Ÿä¸ç­‰ã€‚å»äº«å—ä¸€æ¯ â˜•ï¸å§ï¼Œä½ å€¼å¾—æ‹¥æœ‰å®ƒ ğŸ¤—ã€‚

```bash
!mlagents-learn ./config/ppo/SnowballTarget.yaml --env=./training-envs-executables/linux/SnowballTarget/SnowballTarget --run-id="SnowballTarget1" --no-graphics
```

### å°†æ™ºèƒ½ä½“æ¨é€åˆ° Hugging Face Hub 

- ç°åœ¨æˆ‘ä»¬å·²ç»è®­ç»ƒäº†æˆ‘ä»¬çš„æ™ºèƒ½ä½“ï¼Œæˆ‘ä»¬**å‡†å¤‡å°†å®ƒæ¨é€åˆ° Hubï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨ä½ çš„æµè§ˆå™¨ä¸Šå¯è§†åŒ–æ’­æ”¾å®ƒğŸ”¥ã€‚**

ä¸ºäº†èƒ½å¤Ÿåˆ†äº«ä½ çš„æ¨¡å‹åˆ°ç¤¾åŒºï¼Œä½ éœ€è¦éµå¾ªä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š

1ï¸âƒ£ (å¦‚æœæ²¡æœ‰) åˆ›å»ºä¸€ä¸ª HF è´¦å· â¡ https://huggingface.co/join

2ï¸âƒ£ ç™»é™†, ä»ç½‘ç«™ä¸­è·å–è®¤è¯ tokenã€‚
- åˆ›å»ºä¸€ä¸ªå…·æœ‰**å†™æƒé™**çš„æ–° token (https://huggingface.co/settings/tokens)

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/create-token.jpg" alt="Create HF Token">

- å¤åˆ¶ token
- è¿è¡Œä¸‹é¢å•å…ƒæ ¼ä»£ç å¹¶ç²˜è´´ token

```python
from huggingface_hub import notebook_login

notebook_login()
```

å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ Google Colab æˆ–è€… Jupyter Notebookï¼Œä½ éœ€è¦ç”¨è¿™è¡Œå‘½ä»¤æ›¿ä»£ï¼š`huggingface-cli login` (or `login`)

ä¸‹é¢ï¼Œæˆ‘ä»¬éœ€è¦è¿è¡Œ `mlagents-push-to-hf`.

ç„¶åæˆ‘ä»¬å®šä¹‰å››ä¸ªå‚æ•°ï¼š

1. `--run-id`: è®­ç»ƒè¿è¡Œ ID çš„åå­—ã€‚
2. `--local-dir`: æ™ºèƒ½ä½“ä¿å­˜ä½ç½®ï¼Œå†™ä¸º results/<run_id name>, è¿™é‡Œæˆ‘çš„ä¾‹å­æ˜¯ results/First Trainingã€‚
3. `--repo-id`: ä½ æƒ³åˆ›å»ºæˆ–æ›´æ–°Hugging Face repoã€‚ æ ¼å¼æ˜¯ <ä½ çš„ huggingface ç”¨æˆ·å>/<ä»“åº“å>
å¦‚æœä»“åº“ä¸å­˜åœ¨**ä»–ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª**
4. `--commit-message`: è‡ªåŠ¨ HF ä»“åº“ä½¿ç”¨ git ç®¡ç†ï¼Œä½ éœ€è¦å®šä¹‰æäº¤ä¿¡æ¯ã€‚

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/mlagentspushtohub.png" alt="Push to Hub"/>

ç¤ºä¾‹ï¼š

`!mlagents-push-to-hf  --run-id="SnowballTarget1" --local-dir="./results/SnowballTarget1" --repo-id="ThomasSimonini/ppo-SnowballTarget"  --commit-message="First Push"`

```python
!mlagents-push-to-hf  --run-id= # Add your run id  --local-dir= # Your local dir  --repo-id= # Your repo id  --commit-message= # Your commit message
```

å¦åˆ™ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ åº”è¯¥åœ¨è¿‡ç¨‹ç»“æŸæ—¶æœ‰è¿™ä¸ªï¼ˆä½†ä½¿ç”¨ä¸åŒçš„ url ğŸ˜†ï¼‰ï¼š



```
ä½ çš„æ¨¡å‹ä¼šè¢«æ¨é€åˆ° Hubã€‚ä½ å¯ä»¥åœ¨æ­¤å¤„æŸ¥çœ‹ä½ çš„æ¨¡å‹ï¼š https://huggingface.co/ThomasSimonini/ppo-SnowballTarget
```

å®ƒæ˜¯ä½ æ¨¡å‹çš„é“¾æ¥ã€‚å®ƒåŒ…å«ä¸€å¼ è§£é‡Šå¦‚ä½•ä½¿ç”¨å®ƒçš„æ¨¡å‹å¡ã€ä½ çš„ Tensorboard å’Œä½ çš„é…ç½®æ–‡ä»¶ã€‚**æ›´æ£’çš„æ˜¯å®ƒæ˜¯ä¸€ä¸ª git ä»“åº“ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥æœ‰ä¸åŒçš„æäº¤ï¼Œç”¨æ–°çš„æ¨é€æ›´æ–°ä½ ä»“åº“ï¼Œç­‰ç­‰ã€‚**

ä½†ç°åœ¨æœ€å¥½çš„éƒ¨åˆ†æ¥äº†ï¼š**å¯ä»¥åœ¨çº¿å¯è§†åŒ–æ‚¨çš„æ™ºèƒ½ä½“ ğŸ‘€ã€‚**

### è§‚çœ‹ä½ çš„æ™ºèƒ½ä½“ ğŸ‘€

æ­¥éª¤å¾ˆç®€å•ï¼š

1. è®°ä½ä½ çš„ repo-id

2. è½¬åˆ°è¿™é‡Œï¼š https://singularite.itch.io/snowballtarget

3. è¿è¡Œæ¸¸æˆå¹¶ä¸”é€šè¿‡å³ä¸‹è§’æŒ‰é’®è¿›å…¥å…¨å±

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/snowballtarget_load.png" alt="Snowballtarget load"/>

1. æ­¥éª¤ 1 ï¼Œé€‰æ‹©ä½ çš„æ¨¡å‹ä»“åº“Iï¼Œå°±æ˜¯ä½ çš„æ¨¡å‹ id(æˆ‘è¿™é‡Œæ˜¯ ThomasSimonini/ppo-SnowballTarget)ã€‚

2. æ­¥éª¤ 2ï¼Œ**é€‰æ‹©ä½ æƒ³è¦å›æ”¾çš„æ¨¡å‹**ï¼š
  - æˆ‘æ¯éš” 500000 æ—¶é—´æˆ³ä¿å­˜ä¸€æ¬¡æ‰€ä»¥æœ‰å¤šä¸ªæ¨¡å‹ã€‚
  - ä½†å¦‚æœæˆ‘ä»¬æƒ³è¦æœ€è¿‘å°±é€‰æ‹© `SnowballTarget.onnx` 

ğŸ‘‰ æœ€å¥½å»**å°è¯•ä¸åŒçš„æ¨¡å‹æ­¥éª¤çœ‹æ™ºèƒ½ä½“çš„æå‡ã€‚**


ä¸è¦çŠ¹è±«ï¼Œå°†ä½ çš„æ™ºèƒ½ä½“è·å¾—çš„æœ€ä½³å¾—åˆ†çš„åˆ†äº«åˆ° Discord ä¸Šçš„ #rl-i-made-this é¢‘é“ä¸­ ğŸ”¥

ç°åœ¨è®©æˆ‘ä»¬å°è¯•æ›´æœ‰æŒ‘æˆ˜æ€§çš„ç¯å¢ƒå«åš Pyramidsã€‚

## Pyramids ğŸ†

### ä¸‹è½½å¹¶ç§»åŠ¨ç¯å¢ƒ zip æ–‡ä»¶åˆ° `./training-envs-executables/linux/`
- æˆ‘ä»¬çš„ç¯å¢ƒçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ä¸€ä¸ª zip æ–‡ä»¶ä¸­ã€‚
- æˆ‘ä»¬éœ€è¦ä¸‹è½½å®ƒå¹¶å°†å…¶æ”¾åˆ° `./training-envs-executables/linux/`
- å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ colab æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ Liunx å¯æ‰§è¡Œæ–‡ä»¶ï¼Œcolab çš„æœºå™¨æ“ä½œç³»ç»Ÿæ˜¯ Ubuntu (linux)

ä½¿ç”¨ `wget` ä» https://drive.google.com/uc?export=download&id=1UiFNdKlsH0NTu32xV-giYUEVKV4-vc7H ä¸­ä¸‹è½½ Pyramids.zip æ–‡ä»¶ã€‚[åœ¨è¿™é‡Œ](https://bcrf.biochem.wisc.edu/2021/02/05/download-google-drive-files-using-wget/)æŸ¥çœ‹ä» GDrive ä¸‹è½½å¤§æ–‡ä»¶çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

```python
!wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id=1UiFNdKlsH0NTu32xV-giYUEVKV4-vc7H' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&id=1UiFNdKlsH0NTu32xV-giYUEVKV4-vc7H" -O ./training-envs-executables/linux/Pyramids.zip && rm -rf /tmp/cookies.txt
```

è§£å‹å®ƒ

```python
%%capture
!unzip -d ./training-envs-executables/linux/ ./training-envs-executables/linux/Pyramids.zip
```

ç¡®ä¿ä½ çš„æ–‡ä»¶å¯è®¿é—®

```python
!chmod -R 755 ./training-envs-executables/linux/Pyramids/Pyramids
```

### ä¿®æ”¹ PyramidsRND é…ç½®æ–‡ä»¶
- ä¸ç¬¬ä¸€ä¸ªç¯å¢ƒä¸åŒï¼ŒPyramids **æ˜¯ç”± Unity å›¢é˜Ÿåˆ¶ä½œçš„**ã€‚
- PyramidsRND é…ç½®æ–‡ä»¶å·²ç»å­˜åœ¨äº ./content/ml-agents/config/ppo/PyramidsRND.yaml ä¸­ã€‚
- ä½ å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆ PyramidsRND ä¸­æœ‰ â€œRNDâ€ã€‚RND ä»£è¡¨*éšæœºç½‘ç»œè’¸é¦*ï¼Œè¿™æ˜¯ä¸€ç§ç”Ÿæˆå¥½å¥‡å¿ƒå¥–åŠ±çš„æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬æ’°å†™çš„æœ‰å…³è¯¥æŠ€æœ¯çš„æ–‡ç« ï¼šhttps://medium.com/data-from-the-trenches/curiosity-driven-learning-through-random-network-distillation-488ffd8e5938

å¯¹äºæ­¤æ¬¡è®­ç»ƒï¼Œæˆ‘ä»¬å°†ä¿®æ”¹ä¸€é¡¹å†…å®¹ï¼š
- æ€»è®­ç»ƒæ­¥éª¤è¶…å‚æ•°å¤ªé«˜ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦ 100 ä¸‡æ¬¡è®­ç»ƒæ­¥éª¤å°±å¯ä»¥è¾¾åˆ°åŸºå‡†(å¹³å‡å¥–åŠ±=1.75)ã€‚
ğŸ‘‰ ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¿›å…¥ config/ppo/PyramidsRND.yamlï¼Œ**å¹¶å°† max_steps ä¿®æ”¹ä¸º 1000000ã€‚**


<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit7/pyramids-config.png" alt="Pyramids config"/>

ä½œä¸ºå®éªŒï¼Œå°½é‡ä¼˜åŒ–ä¸€äº›å…¶ä»–è¶…å‚æ•°ã€‚Unity åœ¨è¿™é‡Œæä¾›äº†[éå¸¸å¥½çš„æ–‡æ¡£å»è§£é‡Šæ¯ä¸€ä¸ªè¶…å‚æ•°](https://github.com/Unity-Technologies/ml-agents/blob/main/docs/Training-Configuration-File.md)ã€‚

æˆ‘ä»¬ç°åœ¨å‡†å¤‡å¥½è®­ç»ƒæˆ‘ä»¬çš„æ™ºèƒ½ä½“äº† ğŸ”¥ã€‚

### è®­ç»ƒæ™ºèƒ½ä½“

è®­ç»ƒå°†æ ¹æ®ä½ çš„é…ç½®éœ€è¦ 30 è‡³ 45 åˆ†é’Ÿä¸ç­‰ã€‚å»äº«å—ä¸€æ¯ â˜•ï¸å§ï¼Œä½ å€¼å¾—æ‹¥æœ‰å®ƒ ğŸ¤—ã€‚

```python
!mlagents-learn ./config/ppo/PyramidsRND.yaml --env=./training-envs-executables/linux/Pyramids/Pyramids --run-id="Pyramids Training" --no-graphics
```

### å°†æ™ºèƒ½ä½“æ¨é€åˆ° Hugging Face Hub 

- ç°åœ¨æˆ‘ä»¬å·²ç»è®­ç»ƒäº†æˆ‘ä»¬çš„æ™ºèƒ½ä½“ï¼Œæˆ‘ä»¬**å‡†å¤‡å°†å®ƒæ¨é€åˆ° Hubï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨ä½ çš„æµè§ˆå™¨ä¸Šå¯è§†åŒ–æ’­æ”¾å®ƒğŸ”¥ã€‚**

```bash
!mlagents-push-to-hf  --run-id= # Add your run id  --local-dir= # Your local dir  --repo-id= # Your repo id  --commit-message= # Your commit message
```

### è§‚çœ‹ä½ çš„æ™ºèƒ½ä½“ğŸ‘€

Pyramids demo çš„ä¸´æ—¶é“¾æ¥: https://singularite.itch.io/pyramids

### ğŸ å¥–åŠ±å†…å®¹ï¼šä¸ºä»€ä¹ˆä¸åœ¨å¦ä¸€ä¸ªç¯å¢ƒä¸Šè¿›è¡Œè®­ç»ƒï¼Ÿ
ç°åœ¨ä½ çŸ¥é“æ€ä¹ˆç”¨ MLAgents è®­ç»ƒä¸€ä¸ªæ™ºèƒ½ä½“ï¼Œ**ä¸ºä»€ä¹ˆä¸å°è¯•å¦ä¸€ä¸ªç¯å¢ƒå‘¢ï¼Ÿ

MLAgents æä¾›äº†18ç§ä¸åŒçš„ç¯å¢ƒï¼Œå¹¶ä¸”æˆ‘ä»¬ç”¨çš„å°±æ˜¯æœ€å¯»å¸¸çš„ä¸€ä¸ªã€‚æœ€å¥½çš„å­¦ä¹ æ–¹æ³•æ˜¯å°è¯•è‡ªå·±çš„äº‹æƒ…ï¼Œä»ä¸­è·å¾—ä¹è¶£ã€‚ã€‚

![cover](https://miro.medium.com/max/1400/0*xERdThTRRM2k_U9f.png)

ä½ æœ‰ Hugging Face ä¸Šå½“å‰å¯ç”¨çš„å®Œæ•´åˆ—è¡¨ ğŸ‘‰ https://github.com/huggingface/ml-agents#the-environments

å¯¹äºå¯è§†åŒ–ä½ çš„æ™ºèƒ½ä½“ç¤ºä¾‹ï¼Œä¸´æ—¶é“¾æ¥æ˜¯ï¼šhttps://singularite.itch.io (ä¸´æ—¶é“¾æ¥ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜å°†ç¤ºä¾‹æ”¾åœ¨ Hugging Face Space ä¸Š)

ç›®å‰æˆ‘ä»¬å·²ç»æ•´åˆäº†ï¼š
- [Worm](https://singularite.itch.io/worm) æ•™**è •è™«çˆ¬è¡Œ**çš„ç¤ºä¾‹ã€‚
- [Walker](https://singularite.itch.io/walker) æ•™æ™ºèƒ½ä½“**èµ°å‘ç‰¹å®šç›®æ ‡**çš„ç¤ºä¾‹ã€‚

å¦‚æœä½ æƒ³åŠ å…¥ä¸€äº›æ–°çš„ç¤ºä¾‹ï¼Œè¯·å¼€ä¸€ä¸ª issue: https://github.com/huggingface/deep-rl-class ğŸ¤—

è¿™æ˜¯ä»Šå¤©çš„å…¨éƒ¨å†…å®¹ï¼Œæ­å–œå®Œæˆæœ¬ç« æ•™ç¨‹ï¼

æœ€å¥½çš„å­¦ä¹ æ–¹æ³•æ˜¯ç»ƒä¹ å’Œå°è¯•ã€‚ä¸ºä»€ä¹ˆä¸å°è¯•å¦ä¸€ä¸ªç¯å¢ƒï¼ŸML-Agents æœ‰ 18 ç§ä¸åŒçš„ç¯å¢ƒï¼Œä½†ä½ ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„ç¯å¢ƒï¼ŒæŸ¥çœ‹æ–‡æ¡£ï¼Œç©å¾—å¼€å¿ƒï¼


æˆ‘ä»¬ç¬¬ 6 å•å…ƒè§ ğŸ”¥,

## ä¿æŒçƒ­çˆ±ï¼Œå¥”èµ´å±±æµ· ğŸ¤—
